---
title: Python风格指南
date: '2021-09-07'
tags: ['Python', '笔记']
draft: false
summary: Google的Python风格指南的阅读笔记
---

本篇记录一下自己在阅读 Google 的[Python 风格指南](https://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/python_style_rules/#)的阅读笔记，仅供个人记忆，可读性较差

1. 行长度
   1. 不要超过 80 个字符
   2. 例外情况
      1. 长的 import 语句
      2. 注释中长的 URL、路径等长标记
      3. 一些不方便换行的模块级别字符串常量，如 URL、路径
   3. 尽量避免用反斜杠连接行，除非是一个 with 跟三个及以上上下文管理器
   4. 对于长的行，可以利用圆括号，因为圆括号可以把行隐式连接起来
2. 括号
   1. 尽量避免使用括号
3. 缩进
   1. 绝对不要用 tab 或者将 tab 与空格混用，而应该始终用 4 个空格
   2. 如果是行连接的情况：
      1. 要么垂直对齐
      2. 要么使用 4 个空格的悬挂式缩进
4. 序列元素尾部逗号
   1. 仅在),],}与末尾元素不在同一行时，末尾元素后才需要有逗号
5. 空行
   1. 顶级定义空两行，方法之间空一行
6. Shebang
   1. shebang 指的是脚本开始的#! 行，它可以帮助内核找到执行脚本的解析器
   2. main 文件需要有 shebang，以`#! Usr/bin/python3`开始
7. Docstring
   1. 以三重双引号包括，首先包含对函数的解释，接下来是 args, returns/yields, raises
   2. 对代码中的技巧性部分进行注释，不要描述代码，而是说清楚在做什么
8. 类
   1. 如果类不从其它类继承，那么就从 object 类继承，不要有空继承
   2. 这样可以使 property 正常工作，并预先定义了一些特殊方法
9. 字符串
   1. 在使用+和%之间好好衡量一下
   2. 不要累加字符串，因为字符串是常量，累加字符串会导致二次的复杂度，应该使用 join 函数连接多个字符串
10. 用 with 来管理文件、socket 等的开关，防止资源浪费、长时间占用资源
    1. 如何自定义一个类使用 with
       1. 类定义两种方法`__enter__`和`__exit__`
       2. 用@contextmanager 来装饰函数
    2. 其实可以把 with 理解成，在执行某段代码之前做某事，在执行结束之后再做某事
    3. 如果没有使用上述两种方法，将不能由 with 来调用，但是可以用`contextli2.closing`来创建一个默认的上下文管理器
11. TODO
    1. 写 TODO 的人最好写上自己的名字！
    2. 并且可以加一个截止日期（或者做完某件事之后）
12. 导入顺序
    1. 应该按照如下顺序 import: `__future__`， 标准库，第三方库，本地代码子包
13. 命名规范
    1. ![Python规范](/static/images/PythonFormat.png)
    2. 单下划线开头的模块级别变量、函数是 protected 的，即`from xxx import *`时不会被引入
    3. 双下划线开头的类级别变量是类内私有的
14. main 文件也应该可以被导入，因此，脚本的内容应当写在`if __name__ == '__main__‘`中
15. 函数长度尽量不要超过 40 行
