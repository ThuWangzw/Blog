---
title: 2022秋招八股文笔记《云原生6-存储》
date: '2022-07-23'
tags: ['云原生', '笔记', '秋招', '八股文']
draft: false
summary: 2022秋招八股文笔记《云原生6-存储》
---

1. 什么是 PV 和 PVC
   1. PV 由集群管理人员维护，描述的是一个持久化存储卷，例如对于 NFS，包含一个远程存储(远程块存储或者文件存储)的地址和存储大小，还包括该 PV 的名称以及 storageClassName
   2. PVC 由开发人员编写，可以指定申请的空间大小，以及 storageClassName。、
   3. PersitentVolumeController 负责将 PV 与合适的 PVC 绑定，将结果记录在 spe3.volumeName 中
   4. PV 和 PVC 是一一对应的，然而多个 pod 可以绑定一个 PVC
2. Pod 如何使用 Volume？
   1. 首先在 volumes 字段中添加要使用的 volume，对于 pvc 而言，就声明一下 pvc 的名字
   2. 其次在 container 的声明中，可以把 volume 和 path 绑定起来。
3. K8s 如何使用远程存储服务来做持久化存储？
   1. 本质上讲，k8s 需要做的事情是：在宿主机的 volume 目录下建立一个文件夹，将其与远程存储连接，并将该文件夹绑定挂载到对应的容器中。
   2. 具体步骤分为两阶段
      1. Attach 阶段：这一阶段仅针对块存储(可以把块存储认为是一块磁盘)。K8s 调用远程存储的接口，将远程存储挂载到宿主机上，体现为成为宿主机的一块磁盘。这一阶段在 master 节点执行
      2. Mount 阶段：对于块存储，将磁盘绑定到挂载点上；对于文件存储，直接将 nfs 服务器地址绑定到挂载点上。这一阶段在 kubelet 执行
   3. 完成两阶段之后，就只需要在启动容器时，将对应的文件夹绑定挂载到容器的对应目录即可
4. 如何动态的创建 PV？Dynamic Provisioning

   1. 使用 StorageClass，相当于声明了一个 PV 从创建的模板，当创建 pvc 时，会自动的根据 storageClass 去创建 PV，并将 PV 与 PVC 绑定。

   ![storage](/static/images/storage.png)
